---
title: "p8105_fp_ds100_yg2625"
author: "Yue Gu"
date: "11/30/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```
### Regression Model Analysis
#### Load BRFSS & Injury Data
```{r read_data, message = FALSE}
brfss_data = read_csv("./data/brfss_data.csv") %>% 
  janitor::clean_names()

injury_data = read_csv("./data/NCHS_-_Injury_Mortality__United_States.csv") %>% 
  janitor::clean_names()

```
#### Convert variables into 'factor' to fit a linear model
```{r convert_var}
new_injury = 
  injury_data %>% 
  filter(injury_mechanism == "All Mechanisms",
         injury_intent == "Suicide",
         year  %in%  c(2011, 2012, 2013, 2014, 2015, 2016),
         age_group_years != "All Ages",
         race != "All races",
         sex != "Both sexes") %>%
  mutate(suicide_dr = (deaths / population) * 100000) %>% 
  select(year, sex, age_group_years, race, suicide_dr) %>% 
  mutate(sex = as.factor(ifelse(sex == "Male", 0, 1)),
         race = as.factor(ifelse(race == "Non-Hispanic white", "white", "non-white")),
         age_group_years = as.factor(age_group_years),
         year = as.factor(year))
  
```
#### Construct a regression model using 'suicide death rate' as the outcome of interest with 'sex', 'age group' and 'race' being its predictors
```{r lm}
fit_suicide = lm(suicide_dr ~ sex + race + age_group_years + year, data = new_injury)
summary(fit_suicide)

pairwise.t.test(new_injury$suicide_dr, new_injury$age_group_years, p.adj = 'bonferroni')

fit_suicide %>% aov(.) %>%  TukeyHSD()
```

